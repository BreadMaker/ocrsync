const electron=require("electron");const{ipcRenderer:ipcRenderer,shell:shell}=electron;var template=String(),latestOCR=Number(),currentOCR=3618;$.fn.random=function(){return this.eq(Math.floor(Math.random()*this.length))};function sleep(t){return new Promise(e=>setTimeout(e,t))}function getTextNodesIn(t,e){var n=[],i=/\S/;function o(t){if(t.nodeType==3){if(e||i.test(t.nodeValue)){n.push(t)}}else{for(var r=0,a=t.childNodes.length;r<a;++r){o(t.childNodes[r])}}}o(t);return n}function checkSyncStatus(){$.get("http://ocremix.org/feeds/ten20/",function(t){latestOCR=parseInt($(t).find("item:first link").text().split("/")[4].replace("OCR",""));$("#last").text(latestOCR);var e=latestOCR-currentOCR;if(e===0){$("#OCRStatus").html("SYNC")}else if(e>0){$("#OCRStatus").html("<i class='exclamation triangle icon'></i> Out of sync. "+e+" missing.")}else{$("#OCRStatus").html("WEIRDERROR")}}).fail(function(){$("#OCRStatus").html("<i class='exclamation icon'></i> Something weird happened")})}async function startSync(){var t=3618;$.get("http://ocremix.org/remix/OCR"+t.toString().padStart(5,"0"),function(e){var n=$(e,document.implementation.createHTMLDocument());var i=$(".color-secondary:contains('ReMix')",n).parents("div:first");var o=getTextNodesIn($("h1",i)[0]);$("#OCRSyncProgressDetail").prepend(Mustache.render(template,{remix:t,thumb:e.split('og:image" content="')[1].split('"')[0].replace("ocremix.org","ocremix.org/thumbs/100"),game:o[1].textContent,title:o[2].textContent+" "+$("h2",i).text()}));ipcRenderer.send("OCR:URLReady",t,$("#modalDownload ul li a",n).random()[0].href,localStorage.getItem("OCRDirectory"))})}var triangleArray=[];function initCanvas(){$("#OCRLoadingScreen").remove();$("#OCRMainScreen").removeClass("transparent");var t=document.getElementById("OCRBackgroundCanvas");var e=t.width=window.innerWidth;var n=t.height=window.innerHeight;var i=t.getContext("2d",{alpha:false});var o=document.getElementById("OCRForegroundCanvas");o.width=window.innerWidth;o.height=window.innerHeight;var r=o.getContext("2d");function a(){r.font='bold 48px "Expletus Sans"';r.fillStyle="#444";r.textBaseline="middle";r.textAlign="center";r.fillText("OCRSync",window.innerWidth/2,150)}a();var l=document.getElementById("OCRIntroCanvas");l.width=window.innerWidth;l.height=window.innerHeight;var s=l.getContext("2d");s.fillStyle="white";s.fillRect(0,0,window.innerWidth,window.innerHeight);function c(t,e,n,o){this.x=t;this.y=e;this.status=n;this.up=o;this.deltaLight=Math.random()<.5?h(0,.6):h(0,-.6);this.statusColor=function(t){this.status=t;if(this.status==="error"){this.hue=0;this.saturation="100%";this.lightMin=90;this.lightMax=100}else if(this.status==="warning"){this.hue=60;this.saturation="60%";this.lightMin=60;this.lightMax=100}else{this.hue=Number();this.saturation="0%";this.lightMin=80;this.lightMax=100}this.lightness=h(this.lightMin,this.lightMax)};this.statusColor();this.draw=function(){i.fillStyle="hsl("+this.hue+", "+this.saturation+", "+this.lightness+"%)";if(this.up){i.beginPath();i.moveTo(this.x,this.y);i.lineTo(t+20,this.y+40);i.lineTo(t-20,this.y+40);i.closePath();i.fill()}else{i.beginPath();i.moveTo(this.x,this.y);i.lineTo(t+40,this.y);i.lineTo(t+20,this.y+40);i.closePath();i.fill()}};this.update=function(){this.lightness+=this.deltaLight;if(this.lightness>this.lightMax||this.lightness<this.lightMin){this.deltaLight*=-1}this.draw()}}function h(t,e){return Math.floor(Math.random()*(e-t+1)+t)}function u(t){var i=Math.ceil(e/40)+1;var o=Math.ceil(n/40);var r,a;for(a=0;a<o;a++){for(r=0;r<i;r++){var l=r*40;var s=a*40;if(a%2!=0){l-=20}triangleArray.push(new c(l,s,t,true));triangleArray.push(new c(l,s,t,false))}}}function d(){for(var t=0;t<triangleArray.length;t++){triangleArray[t].update()}}var f=30;var g;var C=Date.now();var m=1e3/f;var R;function w(){requestAnimationFrame(w);g=Date.now();R=g-C;if(R>m){C=g-R%m;d()}}u();w();var p=100;function S(){s.clearRect(0,0,window.innerWidth,window.innerHeight);s.globalAlpha=p/100;s.fillStyle="white";s.fillRect(0,0,window.innerWidth,window.innerHeight);if(p>=0){requestAnimationFrame(S)}else{$("#OCRIntroCanvas").remove();$("#OCRSyncScreen").removeClass("transparent")}p-=2}S();$(window).resize(function(){t.width=window.innerWidth;t.height=window.innerHeight;r.clearRect(0,0,o.width,o.height);o.width=window.innerWidth;o.height=window.innerHeight;a()})}function showConfig(t){$("#OCRConfigModal").modal({onApprove:function(){if(t){initSync()}}}).modal("show")}function backToMainScreen(){$("#OCRMainScreen").removeClass("showingSync")}function initSync(){if(localStorage.getItem("OCRDirectory")===null||localStorage.getItem("OCRTorrentStrat")===null){$("#OCRInitModal").modal({onApprove:function(){showConfig(true)}}).modal("show")}else{$(".modal").modal("hide");$("#OCRMainScreen").addClass("showingSync")}}$(document).ready(function(){template=$("#OCRItemTemplate").html();$(".ui.modal").modal();$("#OCRConfigModal .help").each(function(){$(this).popup({target:$(this).find(".target")})});document.fonts.ready.then(function(){if(document.fonts.check('1em "Expletus Sans"')){$("body").removeClass("expletus");initCanvas()}});var t=Number();ipcRenderer.on("OCR:DownloadProgress",function(e,n,i){console.log(i,n);if(!(t===n&&n===1)){$("#OCReMix-"+i+" .progress").progress({percent:n*100,text:{active:"xxx MB/s",success:"Done!"}})}t=n});$("#OCRConfigButton").click(function(){showConfig(false)});ipcRenderer.on("OCR:ShowConfig",function(){showConfig(false)});$("#OCRSelectDirectoryButton").click(function(t){t.preventDefault();ipcRenderer.send("OCR:SelectDirectory")});ipcRenderer.on("OCR:DirectorySelected",function(t,e){if(e!==null){localStorage.setItem("OCRDirectory",e[0]);$("#OCRDirectory").val(e[0])}});$("#OCRCancelSyncButton").click(function(t){t.preventDefault();backToMainScreen()});$("#OCRAboutButton").click(function(){$("#OCRAboutModal").modal("show")});ipcRenderer.on("OCR:ShowAbout",function(){$("#OCRAboutModal").modal("show")});$("#OCRSyncButton").click(function(t){t.preventDefault();initSync()});ipcRenderer.on("OCR:InitSync",function(){initSync()});if(localStorage.getItem("OCRDirectory")!==null){$("#OCRDirectory").val(localStorage.getItem("OCRDirectory"))}if(localStorage.getItem("OCRTorrentStrat")!==null){$("#OCRTorrentStrat").val(localStorage.getItem("OCRTorrentStrat"))}$(".current.year").text((new Date).getFullYear());$("a").click(function(t){t.preventDefault();shell.openExternal($(this).attr("href"))});$("#OCRCreditsButton").state({text:{inactive:"Credits",active:"About"}}).click(function(){$(".shape").shape("flip back")});$("#OCRTorrentStrat").dropdown({onChange:function(t){localStorage.setItem("OCRTorrentStrat",t)}});checkSyncStatus()});
//# sourceMappingURL=index.min.js.map